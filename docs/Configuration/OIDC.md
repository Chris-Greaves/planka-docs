#### Single Sign on with OIDC

Planka can be configured to use an OIDC provider for logging in. If a user doesn't exist it will be automatically created. If a user exists and the preferred_username claim matches the username stored in planka the accounts will be linked. 

#### Configuration Values
* **OIDC_ISSUER**: URL pointing to the identity provider. This is used to bull the `.well-known/openid-configuration` endpoint that is used to identify the necessary endpoints. 
* **OIDC_AUDIENCE**: The audience is used to verify the access token was intended to be used with planka. This value usually matches the client id. The OAUTH client should be a public client.
* **OIDC_CLIENT_ID**: The OAUTH client id you created in the identity provider. 
* **OIDC_ROLES_ATTRIBUTE**: The claim containing the group/roles that will be used to identify an admin. It is expected that this will be a flat list. 
* **OIDC_ADMIN_ROLES** looks in the claim declared by `OIDC_ROLES_ATTRIBUTE` to see if the user is an admin. 
* **OIDC_REDIRECT_URI** the url to redirect to after login. Should be set to your domain at route `/OidcLogin`. for example if your domain was example.com then the redirect url will be `https://example.com/OidcLogin`.
* **OIDC_JWKS_URI** The JWKS uri. This can be retrieved from the `.well-known/openid-configuration` endpoint. 
* **OIDC_SKIP_USER_INFO** the user_info endpoint is part of the OIDC standard and can be used to pull more information about the user than what is in the access token. Using the user info endpoint allows the access token to be smaller and reduces what is exposed to the browser. If you are using thicker access tokens and don't want to make the extra call to the user info endpoint you can set this value to `true` to turn the call off. 
* **OIDC_SCOPES** scopes to request from the identity provider. this controls what values the OAuth client has access to. Planka needs the name, preferred_username and email claims. By default it requests `openid profile email`

####  Example configuration
This is an example of the environment variables used to configure planka to use [Authentik](https://goauthentik.io/ "Homepage for authentik"). It will work with any OIDC provider. 

```
OIDC_ISSUER="https://auth.local/application/o/planka/"
OIDC_AUDIENCE="sxxaAIAxVXlCxTmc1YLHBbQr8NL8MqLI2DUbt42d"
OIDC_CLIENT_ID="sxxaAIAxVXlCxTmc1YLHBbQr8NL8MqLI2DUbt42d"
OIDC_ROLES_ATTRIBUTE='groups'
OIDC_ADMIN_ROLES="planka-admin"
OIDC_REDIRECT_URI="http://planka.local/OidcLogin"
OIDC_JWKS_URI="https://auth.local/application/o/planka/jwks/"
OIDC_SKIP_USER_INFO='false'
OIDC_SCOPES='openid profile email'
```

At least these values will need to be modified

* auth.local is the domain authentik is running on
* planka.local is the domain planka is configured on. 
* sxxaAIAxVXlCxTmc1YLHBbQr8NL8MqLI2DUbt42d is the client id generated by authentik. 
* create planka-admin group in authentik. This is used to create admin accounts. 